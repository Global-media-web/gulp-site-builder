# Сборка Gulp для вёрстки

## Выполняемые задачи
- Сборка html с использованием [Pug](https://pugjs.org)
- Обработка css с использованием [PostCSS](https://postcss.org/)
- Обработка JS кода [Webpack](https://webpack.js.org/), [Babel](https://babeljs.io/)
- Обработка изображений ([ImageMin](https://github.com/imagemin/imagemin), [MozJPEG](https://github.com/mozilla/mozjpeg))
- Дублирование изображений в формате ```.webp```
- Создание favicon

## Установка
**Для работы сборки требуется установленный [NodeJS](https://nodejs.org/)**
1. Клонируйте этот репозиторий ```git clone https://github.com/Global-media-web/gulp-site-builder.git```
2. Запустите установку командой ```npm i```  

Перед установкой будет проверено наличие глобально установленного пакета [gulp-cli](https://www.npmjs.com/package/gulp-cli), в случае его отсутствия он будет установлен. По окончанию установки будет запущен скрипт, который создаст файловую структуру проекта.


## Структура проекта
- ```build``` *Директория в которую будет собираться проект*
- ```src``` *Директория с исходными файлами*
  - ```css``` *Директория с css файлами.*
  - ```js``` *Директория с js файлами.*
  - ```views``` *Директория с pug файлами*
  - ```img``` *Директория с изображениями*
  - ```favicon``` *Директория для favicon*
  - ```fonts``` *Директория для шрифтов*

## Использование
- Команда запуска сервера разработки ```npm run dev```
- Команда сборки проекта для production ```npm run build```

### Страницы
В корне папки ```src/views``` размещаются только исходные файлы станиц. Для служебных шаблонов и подключаемых файлов нужно завести отдельные директории. Пример:
> ***src***
>
>> ***views***
>>
>>> ***layouts*** - папка с шаблонами  
***parts*** - папка с подключаемыми элементами  
*index.pug* - страница ```index.html```  
*about.pug* - страница ```about.html```

Для пробрасывания локальных переменных в шаблонизатор, в папке ```src/views``` находится файл ```content.json```. 

### Стили
В корне папки ```src/css``` размещаются только те файлы, которые будут явно подключены к странице. Для подключаемых частей и миксинов следует завести отдельные директории.
Стили обрабатываются [PostCSS](https://postcss.org/). 
#### Список подключенных плагинов 
- [postcss-preset-env](https://preset-env.cssdb.org/), опция stage-0
- [postcss-import](https://github.com/postcss/postcss-import)
- [cssnano](https://cssnano.co/) - для production

### Javascript
В корне папки ```src/js``` размещаются только те файлы, которые будут явно покдлючены к странице. Для модулей следует завести отдельную директорию.  

### Изображения
Изображения размещаются в папке ```src/img```. 

### Шрифты
Шрифты размещаются в папке ```src/fonts```.

### Favicon
Исходный файл для favicon необходимо поместить в директорию ```src/favicon```. Файл будет конвертирован в форматы *favicon.png* и *apple-touch-icon* [Подробнее о форматах](https://habr.com/ru/post/260777/). Готовые иконки будут размещены в корне папки ```build``` (рекомендуется размещать иконки в корне сайта), а также будут автоматически подключены в *.html* файлах папки ```build```.

### Production build
При сборке проекта для production дополнительно выполняются следующие шаги:
1. Минификация *css* файлов.
2. Минификация *js* файлов.
3. Изображения обрабатываются [Imagemin](https://github.com/imagemin/imagemin) с подключенным плагином [MozJPEG](https://github.com/mozilla/mozjpeg)).
4. Изображения дублируются в формате *.webp* [Подробнее о WebP](https://ru.wikipedia.org/wiki/WebP).
5. Весь билд запаковывается в zip-архив и помещается в корневую директорию.
